<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>è·¯ç”±åˆ‡æ¢ | Happyblog</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content="åŸºäº vuepress çš„ç®€æ˜“åšå®¢å¹³å°">
    
    <link rel="preload" href="/vuepress-blog/assets/css/0.styles.631b7830.css" as="style"><link rel="preload" href="/vuepress-blog/assets/js/app.f8677ea4.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/2.32f56e5c.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/1.a930a345.js" as="script"><link rel="preload" href="/vuepress-blog/assets/js/58.e4e2e95d.js" as="script"><link rel="prefetch" href="/vuepress-blog/assets/js/10.ab76fc9b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/11.8f72b06d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/12.428f6f98.js"><link rel="prefetch" href="/vuepress-blog/assets/js/13.eb47b2b6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/14.7257e695.js"><link rel="prefetch" href="/vuepress-blog/assets/js/15.bd1b03c3.js"><link rel="prefetch" href="/vuepress-blog/assets/js/16.7a561afc.js"><link rel="prefetch" href="/vuepress-blog/assets/js/17.cd516f79.js"><link rel="prefetch" href="/vuepress-blog/assets/js/18.42e9f2b1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/19.4958156f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/20.cd1f9a1c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/21.e4fea2d1.js"><link rel="prefetch" href="/vuepress-blog/assets/js/22.0919633c.js"><link rel="prefetch" href="/vuepress-blog/assets/js/23.331c698f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/24.5874fb5a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/25.e56a5813.js"><link rel="prefetch" href="/vuepress-blog/assets/js/26.7e912fb0.js"><link rel="prefetch" href="/vuepress-blog/assets/js/27.aa11be6f.js"><link rel="prefetch" href="/vuepress-blog/assets/js/28.b8505e46.js"><link rel="prefetch" href="/vuepress-blog/assets/js/29.155d9866.js"><link rel="prefetch" href="/vuepress-blog/assets/js/3.d7d8640a.js"><link rel="prefetch" href="/vuepress-blog/assets/js/30.80297b92.js"><link rel="prefetch" href="/vuepress-blog/assets/js/31.977ccbdd.js"><link rel="prefetch" href="/vuepress-blog/assets/js/32.767609f9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/33.44891ea8.js"><link rel="prefetch" href="/vuepress-blog/assets/js/34.f516ab0b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/35.151a5daf.js"><link rel="prefetch" href="/vuepress-blog/assets/js/36.ece446f9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/37.37735106.js"><link rel="prefetch" href="/vuepress-blog/assets/js/38.45a9e8b8.js"><link rel="prefetch" href="/vuepress-blog/assets/js/39.0fcd7dcc.js"><link rel="prefetch" href="/vuepress-blog/assets/js/4.ecf7f9e8.js"><link rel="prefetch" href="/vuepress-blog/assets/js/40.621682ab.js"><link rel="prefetch" href="/vuepress-blog/assets/js/41.d03d4354.js"><link rel="prefetch" href="/vuepress-blog/assets/js/42.edf41024.js"><link rel="prefetch" href="/vuepress-blog/assets/js/43.8cd60945.js"><link rel="prefetch" href="/vuepress-blog/assets/js/44.de2cd4e9.js"><link rel="prefetch" href="/vuepress-blog/assets/js/45.4fb41246.js"><link rel="prefetch" href="/vuepress-blog/assets/js/46.b26d762d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/47.3bb572d2.js"><link rel="prefetch" href="/vuepress-blog/assets/js/48.dc6af168.js"><link rel="prefetch" href="/vuepress-blog/assets/js/49.9511edba.js"><link rel="prefetch" href="/vuepress-blog/assets/js/5.8cea2090.js"><link rel="prefetch" href="/vuepress-blog/assets/js/50.2e05304d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/51.f72b0b54.js"><link rel="prefetch" href="/vuepress-blog/assets/js/52.1650a6e6.js"><link rel="prefetch" href="/vuepress-blog/assets/js/53.36c638aa.js"><link rel="prefetch" href="/vuepress-blog/assets/js/54.5931bcf4.js"><link rel="prefetch" href="/vuepress-blog/assets/js/55.f48c6b88.js"><link rel="prefetch" href="/vuepress-blog/assets/js/56.6d799974.js"><link rel="prefetch" href="/vuepress-blog/assets/js/57.0abda071.js"><link rel="prefetch" href="/vuepress-blog/assets/js/59.fc9cc726.js"><link rel="prefetch" href="/vuepress-blog/assets/js/6.5b653d91.js"><link rel="prefetch" href="/vuepress-blog/assets/js/60.d0cdc48d.js"><link rel="prefetch" href="/vuepress-blog/assets/js/61.e663cede.js"><link rel="prefetch" href="/vuepress-blog/assets/js/62.1b3ef15b.js"><link rel="prefetch" href="/vuepress-blog/assets/js/63.b17e2bda.js"><link rel="prefetch" href="/vuepress-blog/assets/js/64.3b7bc255.js"><link rel="prefetch" href="/vuepress-blog/assets/js/65.bb24c420.js"><link rel="prefetch" href="/vuepress-blog/assets/js/7.fcec5877.js"><link rel="prefetch" href="/vuepress-blog/assets/js/vendors~docsearch.a0f89813.js">
    <link rel="stylesheet" href="/vuepress-blog/assets/css/0.styles.631b7830.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-blog/" class="home-link router-link-active"><!----> <span class="site-name">Happyblog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-blog/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/vuepress-blog/miniVue2/" class="nav-link router-link-active">
  mini-Vue2 æ–‡æ¡£
</a></div><div class="nav-item"><a href="/vuepress-blog/performance/" class="nav-link">
  æ€§èƒ½ä¼˜åŒ–
</a></div><div class="nav-item"><a href="/vuepress-blog/chat/" class="nav-link">
  å‰ç«¯æ‚è°ˆ
</a></div><div class="nav-item"><a href="https://github.com/Nwu23787/mini-Vue2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress-blog/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/vuepress-blog/miniVue2/" class="nav-link router-link-active">
  mini-Vue2 æ–‡æ¡£
</a></div><div class="nav-item"><a href="/vuepress-blog/performance/" class="nav-link">
  æ€§èƒ½ä¼˜åŒ–
</a></div><div class="nav-item"><a href="/vuepress-blog/chat/" class="nav-link">
  å‰ç«¯æ‚è°ˆ
</a></div><div class="nav-item"><a href="https://github.com/Nwu23787/mini-Vue2" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mini-Vue2 æ–‡æ¡£</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>mini-Vue-router3 æ–‡æ¡£</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress-blog/miniVue2/router/install.html" class="sidebar-link">install</a></li><li><a href="/vuepress-blog/miniVue2/router/è·¯ç”±æ˜ å°„è¡¨ä¸åŠ¨æ€è·¯ç”±.html" class="sidebar-link">è·¯ç”±æ˜ å°„è¡¨ä¸åŠ¨æ€è·¯ç”±</a></li><li><a href="/vuepress-blog/miniVue2/router/è·¯ç”±åˆ‡æ¢.html" class="active sidebar-link">è·¯ç”±åˆ‡æ¢</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-blog/miniVue2/router/è·¯ç”±åˆ‡æ¢.html#ä¸‰ç§è·¯ç”±æ¨¡å¼" class="sidebar-link">ä¸‰ç§è·¯ç”±æ¨¡å¼</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/miniVue2/router/è·¯ç”±åˆ‡æ¢.html#route-å’Œ-router" class="sidebar-link">$route å’Œ $router</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/miniVue2/router/è·¯ç”±åˆ‡æ¢.html#è·¯ç”±çš„è·³è½¬" class="sidebar-link">è·¯ç”±çš„è·³è½¬</a></li><li class="sidebar-sub-header"><a href="/vuepress-blog/miniVue2/router/è·¯ç”±åˆ‡æ¢.html#vue-router-çš„å“åº”å¼" class="sidebar-link">Vue Router çš„å“åº”å¼</a></li></ul></li><li><a href="/vuepress-blog/miniVue2/router/router-link å’Œ router-view.html" class="sidebar-link">router-link å’Œ router-view</a></li><li><a href="/vuepress-blog/miniVue2/router/å…¨å±€è·¯ç”±å®ˆå«.html" class="sidebar-link">å…¨å±€è·¯ç”±å®ˆå«</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>mini-Vuex3 æ–‡æ¡£</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="è·¯ç”±åˆ‡æ¢"><a href="#è·¯ç”±åˆ‡æ¢" class="header-anchor">#</a> è·¯ç”±åˆ‡æ¢</h1> <h2 id="ä¸‰ç§è·¯ç”±æ¨¡å¼"><a href="#ä¸‰ç§è·¯ç”±æ¨¡å¼" class="header-anchor">#</a> ä¸‰ç§è·¯ç”±æ¨¡å¼</h2> <p>Vue-Router ä¸ºæˆ‘ä»¬æä¾›äº†ä¸‰ç§è·¯ç”±æ¨¡å¼ï¼š<strong>hashã€history å’Œ abstract</strong>ã€‚å…¶ä¸­ abstract æ˜¯ç”¨äºéæµè§ˆå™¨ç¯å¢ƒä¸­çš„ï¼Œå¾ˆå°‘è¢«ä½¿ç”¨ï¼Œæˆ‘ä»¬ä¸è®¨è®ºæ­¤æ¨¡å¼ã€‚</p> <p>hash è·¯ç”±çš„ç‰¹ç‚¹åœ¨äºè·¯å¾„ä¸­å­˜åœ¨ <code>#</code>ï¼Œè¿™ç§å½¢å¼åœ¨å‰ç«¯åˆè¢«æˆä¸º<strong>é”šç‚¹</strong>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ¨¡å¼ä¸‹å‘æœåŠ¡å™¨è¯·æ±‚æ—¶ï¼ŒURL ä¸­ # åçš„å†…å®¹ä¸ä¼šè¢«å¸¦åˆ°æœåŠ¡ç«¯ï¼Œæ‰€ä»¥ hash è·¯ç”±ä¸æ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“ã€‚æ­¤å¤–ï¼Œæ­¤æ¨¡å¼ä¸‹çš„ URL å¾ˆä¸‘ï¼ˆå› ä¸ºæœ‰ <code>#</code>ï¼Œå®˜æ–¹æ–‡æ¡£ç›´è¨€å¾ˆä¸‘ ğŸ˜‚ ï¼Œä¸æ˜¯æˆ‘è¯´çš„ï¼‰ï¼Œæ‰€ä»¥ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬ä¼šä¼˜å…ˆä½¿ç”¨ history æ¨¡å¼ã€‚</p> <p>history è·¯ç”±ä¸­ä¸å­˜åœ¨ <code>#</code>ï¼Œä¸”è¯·æ±‚æ—¶å®Œæ•´çš„è·¯å¾„å¯ä»¥è¢«å¸¦åˆ°åç«¯ï¼Œæ”¯æŒæœåŠ¡ç«¯æ¸²æŸ“ã€‚ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹ Vue-Router æ˜¯å¦‚ä½•åŒºåˆ†è¿™ä¸‰ç§æ¨¡å¼çš„ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>
    <span class="token keyword">let</span> mode <span class="token operator">=</span> options<span class="token punctuation">.</span>mode <span class="token operator">||</span> <span class="token string">'hash'</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>fallback <span class="token operator">=</span> mode <span class="token operator">===</span> <span class="token string">'history'</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>supportsPushState <span class="token operator">&amp;&amp;</span> options<span class="token punctuation">.</span>fallback <span class="token operator">!==</span> <span class="token boolean">false</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>fallback<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      mode <span class="token operator">=</span> <span class="token string">'hash'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>inBrowser<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      mode <span class="token operator">=</span> <span class="token string">'abstract'</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>mode <span class="token operator">=</span> mode
    <span class="token keyword">switch</span> <span class="token punctuation">(</span>mode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'history'</span><span class="token operator">:</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>history <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HTML5History</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>base<span class="token punctuation">)</span>
        <span class="token keyword">break</span>
      <span class="token keyword">case</span> <span class="token string">'hash'</span><span class="token operator">:</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>history <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashHistory</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>base<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>fallback<span class="token punctuation">)</span>
        <span class="token keyword">break</span>
      <span class="token keyword">case</span> <span class="token string">'abstract'</span><span class="token operator">:</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>history <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbstractHistory</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> options<span class="token punctuation">.</span>base<span class="token punctuation">)</span>
        <span class="token keyword">break</span>
      <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">!==</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">assert</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">invalid mode: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>mode<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre></div><ol><li>é¦–å…ˆåˆ¤æ–­ç”¨æˆ·æ˜¯å¦æŒ‡å®šè·¯ç”±æ¨¡å¼ï¼Œè‹¥æœªæŒ‡å®šï¼Œåˆ™<strong>é»˜è®¤ä½¿ç”¨ hash æ¨¡å¼</strong></li> <li>è‹¥ä¸º history æ¨¡å¼ï¼Œå¦‚æœæµè§ˆå™¨ä¸æ”¯æŒ historyï¼Œåˆ™<strong>é™çº§</strong>ä¸º hash æ¨¡å¼ï¼›è‹¥æ­¤æ—¶ä¸å¤„äºæµè§ˆå™¨ç¯å¢ƒä¸­ï¼Œåˆ™<strong>é™çº§</strong>ä¸º abstract æ¨¡å¼</li> <li>æœ€ååˆ†æƒ…å†µï¼Œæ ¹æ®ä¸åŒçš„è·¯ç”±æ¨¡å¼ï¼Œ<strong>åˆ›å»ºä¸åŒçš„ history å¯¹è±¡</strong>ã€‚</li></ol> <h2 id="route-å’Œ-router"><a href="#route-å’Œ-router" class="header-anchor">#</a> $route å’Œ $router</h2> <p>å…³äº history å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œç®¡ç†è·¯ç”±ã€æŒ‚è½½äº†è·¯ç”±ä¿¡æ¯çš„ä¸€ä¸ªå¯¹è±¡ã€‚ä¸åŒæ¨¡å¼ä¸‹åˆ›å»ºçš„è·¯ç”±å¯¹è±¡ä¸åŒï¼Œä½†å·®å¼‚ä¸å¤§ï¼Œä¸»è¦å·®å¼‚åœ¨äºè·¯ç”±è·³è½¬æ—¶å¦‚ä½•ä¿®æ”¹è·¯å¾„å‚æ•°ã€‚</p> <p>ç”±äºæºç ä¸­æ­¤å¤„ä»£ç è¾ƒä¸ºå†—é•¿ï¼Œæœ¬èŠ‚è®²è§£ history å¯¹è±¡é‡‡ç”¨çš„ä»£ç æ¥è‡ªäº mini-vue-router3 ä¸­ã€‚</p> <p>history å¯¹è±¡å®šä¹‰äº history æ–‡ä»¶å¤¹ä¸‹ï¼Œå…¶ä¸­ base æ–‡ä»¶å¤¹ä¸­å®šä¹‰çš„ history ç±»æ˜¯æ‰€æœ‰æ¨¡å¼çš„ history å¯¹è±¡çš„çˆ¶ç±»ï¼Œå…¶ä¸­å®šä¹‰äº†ä¸€ç³»åˆ—å…¬å…±æ–¹æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">class</span> <span class="token class-name">history</span> <span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">router</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>router <span class="token operator">=</span> router

        <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> <span class="token function">createRoute</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token function">transitionTo</span><span class="token punctuation">(</span><span class="token parameter">location<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> record <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span>

        <span class="token keyword">let</span> route <span class="token operator">=</span> <span class="token function">createRoute</span><span class="token punctuation">(</span>record<span class="token punctuation">,</span> location<span class="token punctuation">)</span>

        <span class="token keyword">let</span> queue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span>beforeHooks
        <span class="token comment">// è·³è½¬çš„è·¯å¾„å’ŒåŒ¹é…ç»“æœä¸€è‡´</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>location <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span>path <span class="token operator">&amp;&amp;</span> route<span class="token punctuation">.</span>matched<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span>matched<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ‹¦æˆªé‡å¤è·³è½¬</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// æ‰§è¡Œå‰ç½®è·¯ç”±å®ˆå«</span>
        <span class="token function">runQueue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> queue<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">,</span> route<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

            <span class="token comment">// æ¯æ¬¡è·³è½¬ï¼Œéƒ½è¦æ›´æ–° current</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> route
            <span class="token keyword">if</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment">// æ›´æ–° _route çš„å€¼</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cb <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cb</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span>

            <span class="token keyword">let</span> afterQueue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span>afterHooks

            <span class="token comment">// æ‰§è¡Œåç½®è·¯ç”±å®ˆå«</span>
            <span class="token function">runQueue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> afterQueue<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">,</span> route<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span>


    <span class="token punctuation">}</span>

    <span class="token function">listen</span><span class="token punctuation">(</span><span class="token parameter">cb</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>cb <span class="token operator">=</span> cb
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å…¶ä¸­æ¯”è¾ƒé‡è¦çš„å‡½æ•°æ˜¯ transitionToï¼Œæ‰€æœ‰çš„è·³è½¬é€»è¾‘å‡éœ€è¦ç»è¿‡æ­¤å‡½æ•°ã€‚æˆ‘ä»¬åé¢ä¼šè¯¦ç»†è®²è§£ã€‚</p> <p>å€¼å¾—ä¸€æçš„æ˜¯ history ä¸ŠæŒ‚è½½çš„ä¸¤ä¸ªå±æ€§ï¼š<strong>router å’Œ current</strong>ï¼Œååˆ†é‡è¦ã€‚å…¶å®ä»–ä»¬å°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„ <strong><code>$router</code> å’Œ <code>$route</code></strong>ã€‚å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ defineproperty åšäº†ä»£ç†ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">'$router'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ä»£ç†ä¸€å±‚ï¼Œä¸é€šè¿‡ this._routerRoot._router æ¥è®¿é—®è·¯ç”±ï¼Œè€Œæ˜¯é€šè¿‡ this.$router çš„ä¾¿æ·æ–¹å¼</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_routerRoot <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_routerRoot<span class="token punctuation">.</span>_router
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span><span class="token class-name">Vue</span><span class="token punctuation">.</span>prototype<span class="token punctuation">,</span> <span class="token string">'$route'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ä»£ç†ä¸€å±‚ï¼Œä¸é€šè¿‡ this._routerRoot._route æ¥è®¿é—®è·¯ç”±ï¼Œè€Œæ˜¯é€šè¿‡ this.$route çš„ä¾¿æ·æ–¹å¼</span>
            <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_routerRoot <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_routerRoot<span class="token punctuation">.</span>_route
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>this._routerRoot._route å…¶å®å°±æ˜¯ä¸º current æ·»åŠ äº†å“åº”å¼ä¹‹åçš„ç»“æœï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å°† current å¯¹è±¡å®šä¹‰ä¸ºå“åº”å¼ï¼Œå¹¶æŒ‚è½½åˆ°æ ¹å®ä¾‹ä¸Šï¼Œå¯ä»¥é€šè¿‡ this._routerRoot._route æ‹¿åˆ°</span>
Vue<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'_route'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_router<span class="token punctuation">.</span>history<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
</code></pre></div><p>$router å’Œ $route çš„åŒºåˆ«ï¼š</p> <ul><li>$router æ˜¯<strong>å…¨å±€è·¯ç”±å®ä¾‹</strong>ï¼Œä¸»è¦æŒ‚è½½äº†è·¯ç”±ç›¸å…³çš„ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚è·¯ç”±è·³è½¬æ–¹æ³•å’Œè·¯ç”±å®ˆå«é’©å­ç­‰</li> <li>$route å«åš<strong>è·¯ç”±ä¿¡æ¯å¯¹è±¡</strong>ï¼ŒåŒ…å«å½“å‰è·¯ç”±çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œæ¯”å¦‚nameã€metaã€pathã€hashã€queryã€params ç­‰ç­‰ã€‚</li></ul> <h2 id="è·¯ç”±çš„è·³è½¬"><a href="#è·¯ç”±çš„è·³è½¬" class="header-anchor">#</a> è·¯ç”±çš„è·³è½¬</h2> <p>è·¯ç”±çš„è·³è½¬ï¼Œä¸»è¦æ˜¯è°ƒç”¨äº† push æ–¹æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token function">push</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">location</span><span class="token operator">:</span> RawLocation<span class="token punctuation">,</span> onComplete<span class="token operator">?</span><span class="token operator">:</span> Function<span class="token punctuation">,</span> onAbort<span class="token operator">?</span><span class="token operator">:</span> Function</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// $flow-disable-line</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onComplete <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>onAbort <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> Promise <span class="token operator">!==</span> <span class="token string">'undefined'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>history<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>location<span class="token punctuation">,</span> onComplete<span class="token punctuation">,</span> onAbort<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>æ­¤å‡½æ•°æ¥æ”¶1-3ä¸ªå‚æ•°ï¼ŒonComplete ä¸ºè·³è½¬å®Œæˆçš„å›è°ƒï¼ŒonAbort ä¸ºè·³è½¬å¤±è´¥çš„å›è°ƒã€‚è‹¥æ²¡æœ‰ä¼ å…¥ onComplete å’Œ onAbortï¼Œ ä¸”æµè§ˆå™¨ä¸æ”¯æŒ promiseï¼Œ åˆ™ç›´æ¥è°ƒç”¨ <code>this.history.push(location, onComplete, onAbort)</code>ï¼Œå¦åˆ™è¿”å›ä¸€ä¸ª <code>Promise</code> å¯¹è±¡ï¼Œè¿™ä¸ª <code>Promise</code> åœ¨å¯¼èˆªæˆåŠŸæ—¶è¢«è§£æï¼Œå¤±è´¥æ—¶è¢«æ‹’ç»ã€‚</p> <p>histroy çš„ push æ–¹æ³•åœ¨ä¸åŒè·¯ç”±æ¨¡å¼ä¸‹çš„å®ç°ä¸åŒï¼Œä¸‹é¢æˆ‘ä»¬<strong>ä»¥ hash æ¨¡å¼</strong>ä¸ºä¾‹ï¼š</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">push</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">location</span><span class="token operator">:</span> RawLocation<span class="token punctuation">,</span> onComplete<span class="token operator">?</span><span class="token operator">:</span> Function<span class="token punctuation">,</span> onAbort<span class="token operator">?</span><span class="token operator">:</span> Function</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> <span class="token literal-property property">current</span><span class="token operator">:</span> fromRoute <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">transitionTo</span><span class="token punctuation">(</span>
      location<span class="token punctuation">,</span>
      <span class="token parameter">route</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">pushHash</span><span class="token punctuation">(</span>route<span class="token punctuation">.</span>fullPath<span class="token punctuation">)</span>
        <span class="token function">handleScroll</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">,</span> route<span class="token punctuation">,</span> fromRoute<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
        onComplete <span class="token operator">&amp;&amp;</span> <span class="token function">onComplete</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      onAbort
    <span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œä¸»è¦æ˜¯è°ƒç”¨äº† transitionTo æ–¹æ³•ï¼Œå¹¶åœ¨å›è°ƒä¸­æ‰§è¡Œäº† <strong>pushHash</strong> æ–¹æ³•ã€‚è€Œ pushHash çš„åº•å±‚å…¶å®å°±æ˜¯è°ƒç”¨äº† pushState æ–¹æ³•ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">pushState</span> <span class="token punctuation">(</span><span class="token parameter">url<span class="token operator">?</span><span class="token operator">:</span> string<span class="token punctuation">,</span> replace<span class="token operator">?</span><span class="token operator">:</span> boolean</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> history <span class="token operator">=</span> window<span class="token punctuation">.</span>history
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>replace<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      history<span class="token punctuation">.</span><span class="token function">replaceState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> _key <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      _key <span class="token operator">=</span> <span class="token function">genKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> _key <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span>location<span class="token punctuation">[</span>replace <span class="token operator">?</span> <span class="token string">'replace'</span> <span class="token operator">:</span> <span class="token string">'assign'</span><span class="token punctuation">]</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ‰€ä»¥ï¼Œå½’æ ¹ç»“åº•ï¼Œè¿˜æ˜¯ä½¿ç”¨äº†æµè§ˆå™¨çš„ replaceState å’Œ pushState æ¥åšçš„ã€‚</p> <ul><li>replaceStateï¼šåœ¨ä¸æ·»åŠ æ–°çš„å†å²è®°å½•çš„æƒ…å†µä¸‹æ›¿æ¢å½“å‰é¡µé¢çš„ URL</li> <li>pushStateï¼šä¼šå‘æµè§ˆå™¨çš„å†å²è®°å½•æ ˆä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„è®°å½•ï¼Œå› æ­¤ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨çš„åé€€æŒ‰é’®æ—¶ï¼Œä¼šå›åˆ°ä¹‹å‰çš„ URLã€‚</li></ul> <h2 id="vue-router-çš„å“åº”å¼"><a href="#vue-router-çš„å“åº”å¼" class="header-anchor">#</a> Vue Router çš„å“åº”å¼</h2> <p>Vue Router ä¸­çš„å“åº”å¼ä¸»è¦åœ¨äºè·¯ç”±å˜åŒ–ï¼Œéœ€è¦è‡ªåŠ¨æ¸²æŸ“æ–°è·¯ç”±å¯¹åº”çš„ç»„ä»¶ã€‚</p> <p>é¦–å…ˆï¼Œå¦‚ä½•ç›‘å¬åˆ°è·¯ç”±çš„å˜åŒ–ï¼Ÿ</p> <p>å¯¹äºè¿™ä¸ªé—®é¢˜ hash å’Œ history æ¨¡å¼çš„å®ç°ä¸åŒï¼Œåœ¨ Vue Router 3 ä»¥å‰ï¼Œhash æ¨¡å¼ç›‘å¬è·¯ç”±å˜åŒ–é‡‡ç”¨çš„æ˜¯ç›‘å¬ <strong>hashChange</strong> çš„æ–¹å¼ï¼Œè€Œåœ¨ Vue3 ä»¥åï¼Œç›‘å¬çš„æ˜¯å’Œ history ç›¸åŒçš„ <strong>popState</strong> äº‹ä»¶ã€‚</p> <p><strong>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼š</strong></p> <p>æˆ‘ä»¬è°ƒç”¨ pushState å’Œ replaceState æ˜¯<strong>ä¸ä¼šè§¦å‘ popState äº‹ä»¶çš„</strong>ï¼åªæœ‰ç”¨æˆ·ç‚¹å‡»æµè§ˆå™¨å‰è¿› / åé€€æŒ‰é’®æ“ä½œå†å²è®°å½•æ—¶ï¼Œæ‰ä¼šè§¦å‘ï¼æ‰€ä»¥åœ¨ä½¿ç”¨ popState æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ pushState å’Œ replaceState åæ‰‹åŠ¨è°ƒç”¨ä¸€æ¬¡ transitionTo æ–¹æ³•ã€‚è‹¥æ˜¯ç›´æ¥ç›‘å¬ hash å€¼çš„å˜åŒ–åˆ™ä¸å¿…å¦‚æ­¤ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// hash</span>
    <span class="token comment">/**
     * åˆ›å»ºç›‘å¬å™¨ï¼Œç›‘å¬hashå€¼çš„å˜åŒ–
     */</span>
    <span class="token function">setupListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'hashchange'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">transitionTo</span><span class="token punctuation">(</span><span class="token function">getHash</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

<span class="token comment">// history</span>
    <span class="token comment">/**
    * åˆ›å»ºç›‘å¬å™¨ï¼Œç›‘å¬hashå€¼çš„å˜åŒ–
    */</span>
    <span class="token function">setupListeners</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">transitionTo</span><span class="token punctuation">(</span><span class="token function">getPathName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>å…¶æ¬¡ï¼Œè·¯ç”±å˜åŒ–æ—¶å¦‚ä½•å®ç°ç»„ä»¶çš„åˆ‡æ¢ï¼Ÿ</p> <p>è¿™é‡Œå°±è¦ç”¨åˆ°å“åº”å¼äº†ï¼Œåœ¨å‰é¢æˆ‘ä»¬ä¹Ÿæåˆ°è¿‡ï¼Œhistory ä¸Šçš„ current å±æ€§è¢«æˆ‘ä»¬ä½¿ç”¨ Vue æä¾›çš„å·¥å…·æ–¹æ³• <strong>defineReactive</strong> å®šä¹‰ä¸ºäº†<strong>å“åº”å¼å±æ€§</strong>ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å°† current å¯¹è±¡å®šä¹‰ä¸ºå“åº”å¼ï¼Œå¹¶æŒ‚è½½åˆ°æ ¹å®ä¾‹ä¸Šï¼Œå¯ä»¥é€šè¿‡ this._routerRoot._route æ‹¿åˆ°</span>
Vue<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token function">defineReactive</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">'_route'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_router<span class="token punctuation">.</span>history<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
</code></pre></div><p>è¿™ä¸ªå±æ€§ä¿å­˜äº†å½“å‰è·¯ç”±çš„ç›¸å…³ä¿¡æ¯ï¼Œè€Œæ¯æ¬¡é¡µé¢åˆ‡æ¢æ—¶éƒ½éœ€è¦èµ° history.transitionTo æ–¹æ³•ï¼Œåœ¨æ­¤æ–¹æ³•å†…ï¼Œæˆ‘ä»¬ä¼šå¯¹ this.current è¿›è¡Œæ›´æ–°ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token function">transitionTo</span><span class="token punctuation">(</span><span class="token parameter">location<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">let</span> record <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>location<span class="token punctuation">)</span>

        <span class="token keyword">let</span> route <span class="token operator">=</span> <span class="token function">createRoute</span><span class="token punctuation">(</span>record<span class="token punctuation">,</span> location<span class="token punctuation">)</span>

        <span class="token keyword">let</span> queue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span>beforeHooks
        <span class="token comment">// è·³è½¬çš„è·¯å¾„å’ŒåŒ¹é…ç»“æœä¸€è‡´</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>location <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span>path <span class="token operator">&amp;&amp;</span> route<span class="token punctuation">.</span>matched<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">.</span>matched<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ‹¦æˆªé‡å¤è·³è½¬</span>
            <span class="token keyword">return</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// æ‰§è¡Œå‰ç½®è·¯ç”±å®ˆå«</span>
        <span class="token function">runQueue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> queue<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">,</span> route<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>

            <span class="token comment">// æ¯æ¬¡è·³è½¬ï¼Œéƒ½è¦æ›´æ–° current</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>current <span class="token operator">=</span> route
            <span class="token keyword">if</span> <span class="token punctuation">(</span>callback<span class="token punctuation">)</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

            <span class="token comment">// æ›´æ–° _route çš„å€¼</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>cb <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">cb</span><span class="token punctuation">(</span>route<span class="token punctuation">)</span>

            <span class="token keyword">let</span> afterQueue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>router<span class="token punctuation">.</span>afterHooks

            <span class="token comment">// æ‰§è¡Œåç½®è·¯ç”±å®ˆå«</span>
            <span class="token function">runQueue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> afterQueue<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>current<span class="token punctuation">,</span> route<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><p>å› ä¸º current ä¸ºå“åº”å¼æ•°æ®ï¼Œæ‰€ä»¥ current æ›´æ–°ï¼Œä¼šå¯¼è‡´è§†å›¾é‡æ–°æ¸²æŸ“ã€‚</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/vuepress-blog/miniVue2/router/è·¯ç”±æ˜ å°„è¡¨ä¸åŠ¨æ€è·¯ç”±.html" class="prev">
        è·¯ç”±æ˜ å°„è¡¨ä¸åŠ¨æ€è·¯ç”±
      </a></span> <span class="next"><a href="/vuepress-blog/miniVue2/router/router-link å’Œ router-view.html">
        router-link å’Œ router-view
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress-blog/assets/js/app.f8677ea4.js" defer></script><script src="/vuepress-blog/assets/js/2.32f56e5c.js" defer></script><script src="/vuepress-blog/assets/js/1.a930a345.js" defer></script><script src="/vuepress-blog/assets/js/58.e4e2e95d.js" defer></script>
  </body>
</html>
