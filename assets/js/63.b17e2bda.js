(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{408:function(n,o,t){"use strict";t.r(o);var a=t(14),e=Object(a.a)({},(function(){var n=this,o=n._self._c;return o("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[o("h2",{attrs:{id:"白屏时间计算"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#白屏时间计算"}},[n._v("#")]),n._v(" 白屏时间计算")]),n._v(" "),o("p",[n._v("白屏时间 FP = 页面开始渲染时间点 - 页面开始请求时间点")]),n._v(" "),o("p",[o("strong",[n._v("FP = domLoading - fetchStatr")])]),n._v(" "),o("p",[o("code",[n._v("domLoading")]),n._v(" 代表浏览器开始解析html文档的时间节点。")]),n._v(" "),o("p",[o("code",[n._v("fetchStart")]),n._v(" 代表浏览器已经准备好发起网络请求，准备开始请求的时间节点。")]),n._v(" "),o("h2",{attrs:{id:"fps-计算"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#fps-计算"}},[n._v("#")]),n._v(" FPS 计算")]),n._v(" "),o("p",[o("strong",[n._v("FPS（Frames Per Second）")]),n._v("：每秒显示帧数。")]),n._v(" "),o("p",[n._v("计算 FPS 可以利用 requestAnimationFrame API 的特性，假设页面加载用时 x 毫秒，期间 requestAnimationFrame 执行了 n 次，那么 "),o("strong",[n._v("FPS = (n * 1000 ) / x")])]),n._v(" "),o("p",[n._v("但是需要考虑 requestAnimationFrame 的兼容性，详见："),o("a",{attrs:{href:"https://nwu23787.github.io/vuepress-blog/chat/requestAnimationFrame.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("requestAnimationFrame"),o("OutboundLink")],1)]),n._v(" "),o("h2",{attrs:{id:"网络环境情况采集"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#网络环境情况采集"}},[n._v("#")]),n._v(" 网络环境情况采集")]),n._v(" "),o("h3",{attrs:{id:"window-navigator-online"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#window-navigator-online"}},[n._v("#")]),n._v(" window.navigator.onLine")]),n._v(" "),o("p",[n._v("window.navigator.onLine 的属性值为布尔类型，为 true 表示联网，false 表示断开了网络连接。只能简单判断是否联网，无法细分当前的网络状态是 WiFi / 4G / 3G / 2G")]),n._v(" "),o("h3",{attrs:{id:"window-ononline-window-onoffline"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#window-ononline-window-onoffline"}},[n._v("#")]),n._v(" window.ononline / window.onoffline")]),n._v(" "),o("p",[n._v("window.ononline / window.onoffline 是在网络连接恢复和断开时触发的时间，可以监听这两个事件，并在回调中采集。")]),n._v(" "),o("p",[n._v("图片测速法")]),n._v(" "),o("p",[n._v("通过让客户端向服务端请求一个较小体积的图片，在图片请求之初打上一个时间点，在图片 onLoad 事件被触发时再打上一个时间点，使用"),o("strong",[n._v("图片体积除以时间差")]),n._v("就可以获取到当前的网速。需要注意的是，图片"),o("strong",[n._v("体积一定要小")]),n._v("，否则会阻塞业务代码。另外，可以采取多张图片取"),o("strong",[n._v("平均值")]),n._v("的方式来减少网络环境波动带来的误差。")]),n._v(" "),o("h3",{attrs:{id:"navigator-connection"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#navigator-connection"}},[n._v("#")]),n._v(" navigator.connection")]),n._v(" "),o("p",[o("code",[n._v("Navigator")]),n._v(" 接口的 "),o("strong",[o("code",[n._v("connection")])]),n._v(" 只读属性返回一个包含有关系统网络连接信息的 "),o("code",[n._v("NetworkInformation")]),n._v("对象，例如用户设备的当前带宽或连接是否按流量计费。")]),n._v(" "),o("p",[n._v("这可以用于根据用户的连接状态来选择高清晰度内容或低清晰度内容。")]),n._v(" "),o("p",[n._v("可以通过返回值判断用户当前处于 WiFi / 4G / 3G / 2G 中的哪一个网络环境，缺点是"),o("strong",[n._v("兼容性太低")]),n._v("，Firefox 和 Safari 完全不支持，不建议使用。")]),n._v(" "),o("p",[n._v("参考资料：")]),n._v(" "),o("ul",[o("li",[o("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/Navigator/connection",target:"_blank",rel:"noopener noreferrer"}},[n._v("Navigator：connection 属性 - Web API | MDN (mozilla.org)"),o("OutboundLink")],1)])])])}),[],!1,null,null,null);o.default=e.exports}}]);